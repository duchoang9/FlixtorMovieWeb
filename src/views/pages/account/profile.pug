doctype html
html
    head
        title #{title}  
        meta(charset='utf-8')
        meta(name='viewport', content='width=device-width, initial-scale=1')
        link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css")
        link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet")
    body
        header 
            include ../../partials/header.pug
        main
            .mt-5.mx-5.row.justify-content-center
                .col-3
                    h2 User&apos;s profile
                    #error-message.alert.alert-danger.d-none(role='alert')
                .col-5.mt-5
                    form#profile-form(action='/account/profile', method='POST')
                        .input-group.visually-hidden
                            span.input-group-text Id:
                            input#id.form-control(type='number', name='id', value=user.id)
                        .input-group.visually-hidden
                            span.input-group-text Password:
                            input#password.form-control(type='password', name='password', value=user.password)
                        .input-group.mb-4.mt-3
                            span.input-group-text Username:
                            input#username.form-control(type='text', placeholder='Enter username', name='username', value=user.user_name)
                        .input-group.mb-4
                            span.input-group-text Email:
                            input#email.form-control(type='email', placeholder='Enter email', name='email', value=user.email)
                        .input-group.mb-4
                            span.input-group-text Role:
                            input#role.form-control(type='text', disabled readonly, name='role', value=user.role)
                        .input-group
                            span.input-group-text New password:
                            input#newpassword.form-control(type='password', placeholder='Enter new password', name='newpassword', value='')
                            span.input-group-text
                                i#toggleNewPassword.bi.bi-eye-slash(style='cursor: pointer')
                        small.fw-light Ignore this feild if you don&apos;t want to change.
                        .mt-5.mb-3
                            button.btn.btn-lg.btn-primary(type='submit') Save Changes
                .col-4
                    ul.side-bar.list-unstyled.float-end.w-50
                        li.mt-3.mb-2
                            a.btn.btn-primary.w-100.text-start(href='/account/profile', role='button')
                                i.bi.bi-person-lines-fill  Profile
                        li.mb-2
                            a.btn.btn-primary.w-100.text-start(href='/account/watch_list', role='button')
                                i.bi.bi-heart  Watch List
                        li.mb-2
                            a.btn.btn-primary.w-100.text-start(href='/account/signout', role='button')
                                i.bi.bi-box-arrow-right  Sign Out
        footer 
            include ../../partials/footer.pug   

    script(src="https://kit.fontawesome.com/1de5e0d4fc.js" crossorigin="anonymous")
    script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js')
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js')
    script.
        document.querySelector("#toggleNewPassword").addEventListener("click", function () {
            // toggle the type attribute
            const type = document.querySelector("#newpassword").getAttribute("type") === "password" ? "text" : "password";
            document.querySelector("#newpassword").setAttribute("type", type);
            // toggle the eye icon
            this.classList.toggle('bi bi-eye');
            this.classList.toggle('bi bi-eye-slash');
        });
    script.
        $(document).ready(function() {
        $('#profile-form').submit(function(event) {
        event.preventDefault();
        $.ajax({
        url: '/account/profile',
        method: 'POST',
        data: $('#profile-form').serialize(),
        success: function(response) {
        alert(response.message);
        setTimeout(function() {
        window.location.href = '/';
        }, 1000);
        },
        error: function(xhr, status, error) {
        $('#error-message').text(xhr.responseJSON.message);
        $('#error-message').removeClass('d-none');
        }
        });
        });
        });
    


    